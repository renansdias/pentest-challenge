#!/bin/sh

if [[ -z "$TERRAFORM_STATE_BUCKET_NAME" ]]; then
	echo 'Please specify the bucket name for the terraform state file using the TERRAFORM_STATE_BUCKET_NAME variable)'
    echo 'Exiting...'
    exit 1
fi

# Dummy file - It's just so Terraform can destroy the infra. Doesn't need to be a real file.
touch /root/private

terraform init -backend-config="bucket=$TERRAFORM_STATE_BUCKET_NAME"
terraform destroy \
    -force \
    -var "public_key_path=/root/private" \
    -var "workstation_ip=0.0.0.0/0"
